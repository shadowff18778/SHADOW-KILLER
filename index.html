<!DOCTYPE html>
<html lang="fr" oncontextmenu="return false;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHADOW KILLER</title>
    <!-- Utilisation de Tailwind CSS pour un style moderne et r√©actif -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        /* Styles personnalis√©s pour le th√®me de la console et l'effet de glitch */
        html, body {
            height: 100%;
            font-family: 'VT323', monospace;
            background-color: #000000;
            cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='40' height='48' viewport='0 0 100 100' style='fill:white;font-size:24px;'><text y='50%'>üíÄ</text></svg>") 16 16, auto;
            overflow: hidden; /* Emp√™che le d√©filement global de la page */
        }

        /* Effet de balayage pour simuler un √©cran CRT */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            background: repeating-linear-gradient(
                to bottom,
                transparent 0px,
                transparent 1px,
                rgba(255, 255, 255, 0.05) 1px,
                rgba(255, 255, 255, 0.05) 2px
            );
            z-index: 100;
        }

        /* Animation de glitch pour le texte */
        @keyframes text-glitch {
            0% { transform: translate(0); opacity: 1; }
            20% { transform: translate(-2px, -2px); opacity: 0.8; }
            40% { transform: translate(2px, 2px); opacity: 1; }
            60% { transform: translate(-1px, 1px); opacity: 0.9; }
            80% { transform: translate(1px, -1px); opacity: 1; }
            100% { transform: translate(0); opacity: 1; }
        }

        .glitch-text {
            animation: text-glitch 0.5s infinite alternate;
        }
        
        /* Animation de secousse pour la pop-up */
        @keyframes popup-shake {
            0% { transform: translate(-50%, -50%); }
            20% { transform: translate(-52%, -48%); }
            40% { transform: translate(-48%, -52%); }
            60% { transform: translate(-51%, -49%); }
            80% { transform: translate(-49%, -51%); }
            100% { transform: translate(-50%, -50%); }
        }

        /* Animation de scintillement pour un effet d'interf√©rence */
        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .flicker {
            animation: flicker 0.2s infinite alternate;
        }

        /* Effet de clignotement pour le point rouge */
        @keyframes blink-color {
            0%, 100% { background-color: #ff0000; }
            50% { background-color: #000000; }
        }
        
        .blinking-dot {
            animation: blink-color 1s infinite;
        }
        
        /* Barre d'alerte en haut, rouge avec une bordure */
        .alert-bar {
            background-color: #8b0000;
            border-bottom: 2px solid #ff0000;
        }

        /* Pop-up de piratage au centre */
        .hacking-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 400px;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #ff0000;
            box-shadow: 0 0 10px #ff0000;
            z-index: 200;
            display: none;
            animation: popup-shake 0.1s infinite alternate, flicker 0.3s infinite alternate;
        }
        
        /* Pop-up pour le chronom√®tre, sans animation de secousse */
        .timer-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 400px;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #ff0000;
            box-shadow: 0 0 10px #ff0000;
            z-index: 300;
            display: none;
            text-align: center;
        }
        
        .timer-popup-display {
            font-family: 'VT323', monospace;
            font-size: 3rem;
            color: #ff0000;
            text-shadow: 0 0 5px #ff0000;
        }

        .hacking-popup-bar {
            width: 100%;
            height: 5px;
            background: #440000;
            margin-top: 1rem;
            overflow: hidden;
        }

        .hacking-popup-progress {
            height: 100%;
            background-color: #ff0000;
            transition: width linear;
        }

        /* Pop-up pour le code d'acc√®s */
        .code-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 400px;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #ff0000;
            box-shadow: 0 0 10px #ff0000;
            z-index: 300;
            display: none;
            text-align: center;
            animation: popup-shake 0.1s infinite alternate, flicker 0.3s infinite alternate;
        }

        .code-popup input {
            background-color: transparent;
            border-bottom: 2px solid #ff0000;
            color: #ff0000;
            font-size: 1.5rem;
            padding: 0.5rem;
            outline: none;
            text-align: center;
        }
        .code-popup p {
            font-size: 1.2rem;
            color: #ff0000;
        }
        
        .close-button {
            position: absolute;
            top: 5px;
            right: 10px;
            font-size: 1.5rem;
            line-height: 1;
            color: #ff0000;
            cursor: pointer;
        }

        /* Masquer les √©crans au d√©marrage */
        #start-screen, #loading-screen, #main-content {
            display: none;
            position: absolute;
            inset: 0;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        /* Afficher l'√©cran de d√©marrage au chargement */
        #start-screen.active {
            display: flex;
        }

        /* Style du lecteur vid√©o personnalis√© */
        .custom-video-container {
            position: relative;
            width: 100%;
            height: 100%;
        }

        #video-player {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border: none;
            display: block;
        }
        
        /* Superposition des contr√¥les vid√©o personnalis√©s */
        .video-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            padding: 0.5rem;
            border-top: 2px solid #ff0000;
            transition: opacity 0.3s ease-in-out;
        }

        /* Classe pour masquer les contr√¥les avec opacit√© 0 */
        .video-controls.controls-hidden {
            opacity: 0;
            pointer-events: none;
        }

        .play-pause-btn, .fullscreen-btn {
            font-size: 1.5rem;
            color: #ff0000;
            background: none;
            border: none;
            cursor: pointer;
            outline: none;
            width: 3rem;
            text-align: center;
            line-height: 1;
        }

        .progress-bar-container {
            flex-grow: 1;
            height: 5px;
            background: #440000;
            cursor: pointer;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: #ff0000;
            transition: width 0.1s linear;
        }

        .time-display {
            font-size: 0.8rem;
            color: #ff0000;
            margin-left: 0.5rem;
            width: 5rem;
            text-align: right;
        }

        /* Style pour le mode plein √©cran personnalis√© */
        .custom-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw !important;
            height: 100vh !important;
            z-index: 9999;
            background: black;
            border: 2px solid #ff0000;
        }
        
        /* Superposition de verrouillage vid√©o */
        .video-lock-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            color: #ff0000;
            font-size: 1.5rem;
            text-align: center;
            z-index: 10;
        }
        
        /* Superposition de chargement de d√©verrouillage */
        #unlock-loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            z-index: 400;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        /* Animation pour la barre de progression */
        @keyframes load-progress {
            0% { width: 0; }
            100% { width: 100%; }
        }
        
        .loading-progress-bar {
            width: 50%;
            height: 4px;
            background-color: #440000;
            margin-top: 1rem;
            overflow: hidden;
        }
        
        .loading-progress-bar div {
            height: 100%;
            background-color: #ff0000;
            animation: load-progress 3s linear forwards;
        }
        
        /* Animation mise √† jour pour le texte "Powered by SHADOW" */
        @keyframes shadow-text-flicker {
            0%, 100% { 
                opacity: 1;
                /* Ombre de texte plus subtile */
                text-shadow: 0 0 2px #ff0000, 0 0 5px #ff0000; 
            }
            50% { 
                opacity: 0.8;
                text-shadow: none; /* Pas d'ombre au milieu pour l'effet de scintillement */
            }
        }
        
        .shadow-text {
            color: #ff0000;
            font-size: 1rem;
            animation: shadow-text-flicker 1.5s infinite alternate;
        }

        /* Stylisation du message pour la vid√©o non trouv√©e */
        .video-error-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none; /* Masqu√© par d√©faut */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #ff0000;
            font-size: 1.5rem;
            text-align: center;
            z-index: 10;
        }
        
        /* Animation pour l'ic√¥ne d'erreur */
        @keyframes pulse-error {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        .video-error-overlay .error-icon {
            animation: pulse-error 1.5s infinite;
            font-size: 4rem;
        }
        
    </style>
</head>
<body class="bg-black text-white flex flex-col h-full">

    <!-- √âcran de d√©marrage -->
    <div id="start-screen" class="w-full h-full bg-black z-10 active">
        <h1 class="text-3xl text-red-600 mb-8 glitch-text">
            [D√âMARRAGE DU TERMINAL]
        </h1>
        <button id="startButton" class="bg-transparent border-2 border-red-600 text-red-600 px-8 py-4 text-xl hover:bg-red-600 hover:text-black transition-colors glitch-text">
            COMMENCER
        </button>
    </div>

    <!-- √âcran de chargement (masqu√© au d√©marrage) -->
    <div id="loading-screen" class="w-full h-full bg-black z-20">
        <p class="text-xl text-red-600 flicker">
            BOOTING...
        </p>
        <!-- Texte "Powered by SHADOW" avec animation -->
        <p class="shadow-text absolute bottom-4">
            Powered by SHADOW
        </p>
    </div>

    <!-- Contenu principal (masqu√© au d√©marrage) -->
    <div id="main-content" class="w-full flex-1 flex flex-col p-4 hidden">
        <!-- Barre d'alerte en haut -->
        <div class="alert-bar text-sm sm:text-base p-2 flex justify-between items-center text-red-300 flex-shrink-0">
            <!-- Ajout d'un ID pour le titre afin de pouvoir y ajouter un √©v√©nement -->
            <span id="shadowKillerTitle" class="glitch-text text-xl text-red-500 cursor-pointer">SHADOW KILLER</span>
            <!-- Le compteur d'utilisateurs a √©t√© d√©plac√© -->
            <span class="glitch-text text-xl text-red-500"></span>
        </div>

        <!-- Section principale avec vid√©o et chat -->
        <div class="flex-1 flex flex-col sm:flex-row gap-4 mt-4 overflow-hidden min-h-0">
            <!-- Conteneur vid√©o, prend de la place -->
            <div id="video-wrapper" class="w-full sm:w-2/3 flex-shrink-0 flex items-center justify-content-center bg-black relative aspect-video border-2 border-red-600">
                <!-- Lecteur vid√©o personnalis√© -->
                <div class="custom-video-container w-full h-full">
                    <video id="video-player"></video>
                    
                    <!-- Interface de chargement et d'erreur -->
                    <div id="video-status" class="absolute inset-0 bg-black flex items-center justify-content-center text-red-600 text-lg">
                        <p id="video-status-text" class="glitch-text">TENTATIVE DE CONNEXION AU FLUX VID√âO...</p>
                    </div>
                    
                    <!-- Superposition de verrouillage vid√©o -->
                    <div id="video-lock-overlay" class="video-lock-overlay">
                        <p class="glitch-text mb-4">[ACC√àS VID√âO VERROUILL√â]</p>
                        <button id="unlockVideoButton" class="bg-red-600 text-black font-bold p-2 mt-4 glitch-text">
                            D√âVERROUILLER LA VID√âO
                        </button>
                    </div>

                    <!-- Superposition d'erreur vid√©o -->
                    <div id="video-error-overlay" class="video-error-overlay">
                        <span class="error-icon mb-4">‚ò†</span>
                        <p class="glitch-text text-2xl">[VID√âO INACCESSIBLE]</p>
                        <p class="text-sm mt-2 text-gray-400">Le flux vid√©o n'est pas disponible pour le moment.</p>
                    </div>

                    <!-- Contr√¥les du lecteur vid√©o -->
                    <div id="video-controls" class="video-controls controls-hidden glitch-text">
                        <button id="play-pause-btn" class="play-pause-btn glitch-text" disabled>‚ñ∂</button>
                        <div id="progress-bar-container" class="progress-bar-container">
                            <div id="progress-bar" class="progress-bar"></div>
                        </div>
                        <span id="time-display" class="time-display">00:00 / 00:00</span>
                        <button id="fullscreen-btn" class="fullscreen-btn glitch-text">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 inline-block">
                                <path fill-rule="evenodd" d="M3 3.75A.75.75 0 013.75 3h4.5a.75.75 0 010 1.5h-3v3a.75.75 0 01-1.5 0v-4.5zm12 0a.75.75 0 01.75-.75h4.5a.75.75 0 010 1.5h-3v3a.75.75 0 01-1.5 0v-4.5zM3 15.75a.75.75 0 01.75-.75h4.5a.75.75 0 010 1.5h-3v3a.75.75 0 01-1.5 0v-4.5zm12 0a.75.75 0 01.75-.75h4.5a.75.75 0 010 1.5h-3v3a.75.75 0 01-1.5 0v-4.5z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Conteneur du chat, prend l'espace restant et se d√©file -->
            <div class="w-full sm:w-1/3 flex-1 flex flex-col bg-black border-2 border-red-600 min-h-0">
                <!-- Compteur d'utilisateurs maintenant dans cet en-t√™te avec un point clignotant -->
                <h2 class="bg-red-600 text-black text-center text-lg p-2 font-bold flicker flex justify-between items-center px-4 flex-shrink-0">
                    <span>MESSAGES EN DIRECT</span>
                    <span class="flex items-center gap-1 text-sm">
                        <!-- Couleur mise √† jour pour le point clignotant et le texte -->
                        <span class="w-2 h-2 rounded-full blinking-dot"></span>
                        <span id="user-count" class="flicker text-black">1</span>
                    </span>
                </h2>
                <!-- Zone de messages d√©filable -->
                <div id="chatMessages" class="flex-1 overflow-y-auto p-2 text-red-300">
                    <!-- Messages de chat initiaux pour cr√©er l'ambiance -->
                    <p class="flicker"><span class="text-red-500">SYSTEM:</span> Connexion au terminal √©tablie...</p>
                    <p class="flicker"><span class="text-red-500">SYSTEM:</span> Attention, surveillance d√©tect√©e. Votre anonymat est en danger.</p>
                </div>
                <!-- Entr√©e de chat et bouton (fixe) -->
                <div class="flex-shrink-0 mt-auto">
                    <div id="chat-input-container" class="mt-2 p-2 locked">
                        <input type="text" id="messageInput" placeholder="> COMMENCER PAR D√âVERROUILLER LE CHAT..." class="w-full bg-transparent text-red-600 border-b border-red-600 placeholder-red-800 focus:outline-none">
                    </div>
                    <button id="unlockChatButton" class="w-full bg-red-600 text-black font-bold p-2 mt-2 glitch-text">
                        D√âVERROUILLER LE CHAT
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Pop-up effrayante d'IP -->
    <div id="scary-popup" class="hacking-popup">
        <h3 id="popup-text" class="text-lg text-red-500 text-center glitch-text">
            R√âCUP√âRATION DES DONN√âES...
        </h3>
        <div class="hacking-popup-bar">
            <div id="popup-loading-bar" class="hacking-popup-progress"></div>
        </div>
    </div>

    <!-- Pop-up pour le code d'acc√®s -->
    <div id="code-popup" class="code-popup">
        <span class="close-button" id="closeCodePopup">&times;</span>
        <h3 class="text-lg text-red-500 glitch-text mb-4">
            [ACC√àS REQUIS]
        </h3>
        <p class="text-red-300 mb-2">ENTREZ LE CODE D'ACC√àS POUR CONTINUER:</p>
        <input type="password" id="codeInput" maxlength="6">
        <p id="codeError" class="text-red-600 mt-2 hidden">CODE INCORRECT.</p>
        <button id="submitCodeButton" class="bg-red-600 text-black font-bold p-2 mt-4 glitch-text">
            SOUMETTRE
        </button>
    </div>

    <!-- NOUVELLE POP-UP DU CHRONOM√àTRE -->
    <div id="timer-popup" class="timer-popup">
        <span class="close-button" id="closeTimerPopup">&times;</span>
        <h3 class="text-lg text-red-500 glitch-text mb-4">
            [TEMPS PASS√â SUR LE SITE]
        </h3>
        <p id="timer-display" class="timer-popup-display">00:00:00</p>
        <p class="text-red-300 mt-2">Le temps est sauvegard√©.</p>
    </div>
    
    <!-- Superposition de chargement de d√©verrouillage -->
    <div id="unlock-loading-overlay" class="glitch-text" style="display: none;">
        <h3 id="unlock-loading-text" class="text-3xl text-red-600 text-center glitch-text"></h3>
        <div class="loading-progress-bar">
            <div></div>
        </div>
    </div>

    <!-- Nouveaux √©l√©ments audio pour les effets sonores -->
    <!-- Le son d'erreur est en boucle, id√©al pour un effet stressant -->
    <audio id="errorSound" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" preload="auto" loop></audio>
    <audio id="successSound" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" preload="auto"></audio>

    <!-- Script pour la logique du site -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const startScreen = document.getElementById('start-screen');
            const loadingScreen = document.getElementById('loading-screen');
            const mainContent = document.getElementById('main-content');
            const startButton = document.getElementById('startButton');
            const messageInput = document.getElementById('messageInput');
            const chatMessages = document.getElementById('chatMessages');
            const scaryPopup = document.getElementById('scary-popup');
            const popupLoadingBar = document.getElementById('popup-loading-bar');
            const unlockChatButton = document.getElementById('unlockChatButton');
            const chatInputContainer = document.getElementById('chat-input-container');
            const codePopup = document.getElementById('code-popup');
            const codeInput = document.getElementById('codeInput');
            const submitCodeButton = document.getElementById('submitCodeButton');
            const codeError = document.getElementById('codeError');
            const closeCodePopup = document.getElementById('closeCodePopup');
            const userCountDisplay = document.getElementById('user-count');
            
            // √âl√©ments pour la nouvelle animation de chargement
            const unlockLoadingOverlay = document.getElementById('unlock-loading-overlay');
            const unlockLoadingText = document.getElementById('unlock-loading-text');

            // √âl√©ments du lecteur vid√©o
            const videoWrapper = document.getElementById('video-wrapper');
            const videoPlayer = document.getElementById('video-player');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const fullscreenBtn = document.getElementById('fullscreen-btn');
            const progressBar = document.getElementById('progress-bar');
            const progressBarContainer = document.getElementById('progress-bar-container');
            const timeDisplay = document.getElementById('time-display');
            const videoStatus = document.getElementById('video-status');
            const videoStatusText = document.getElementById('video-status-text');
            const videoControls = document.getElementById('video-controls');
            const videoLockOverlay = document.getElementById('video-lock-overlay');
            const unlockVideoButton = document.getElementById('unlockVideoButton');

            // Superposition d'erreur vid√©o
            const videoErrorOverlay = document.getElementById('video-error-overlay');

            // Nouveaux √©l√©ments audio
            const errorSound = document.getElementById('errorSound');
            const successSound = document.getElementById('successSound');

            // NOUVEAUX √âL√âMENTS DU CHRONOM√àTRE
            const shadowKillerTitle = document.getElementById('shadowKillerTitle');
            const timerPopup = document.getElementById('timer-popup');
            const closeTimerPopup = document.getElementById('closeTimerPopup');
            const timerDisplay = document.getElementById('timer-display');
            const localStorageKey = 'shk_time_spent';
            let startTime = 0;
            let totalTimeElapsed = 0;
            let timerInterval = null;
            let timerRunning = false;
            // FIN DES NOUVEAUX √âL√âMENTS

            const CHAT_ACCESS_CODE = "95741";
            const VIDEO_ACCESS_CODE = "95741"; 
            let userLocationData = null;
            let popupsQueue = [];
            let isProcessingPopup = false;
            let controlsHideTimeout = null;
            let userCountInterval = null;
            let successSoundTimeout = null;

            // Liste de messages SYSTEM mise √† jour pour √™tre plus inqui√©tante.
            const chatMessagesList = [
                "SYSTEM: Anomalie d√©tect√©e dans le flux de donn√©es.",
                "SYSTEM: Erreur de checksum. Donn√©es corrompues.",
                "SYSTEM: Vous n'auriez pas d√ª venir ici...",
                "SYSTEM: Avertissement: la connexion est instable. La ligne a √©t√© compromise.",
                "SYSTEM: Le serveur r√©pond mais ne renvoie rien... Une pr√©sence inconnue?",
                "SYSTEM: Je vois... ton visage...",
                "SYSTEM: Une entit√© se connecte au terminal. Nom: inconnue.",
                "SYSTEM: Je n'arrive plus √† bouger ma souris... mon curseur est √† l'envers",
                "SYSTEM: L'appareil n'est plus sous votre contr√¥le.",
                "SYSTEM: Vous allez regretter d'√™tre entr√© sur ce serveur.",
                "SYSTEM: Les pare-feu ont √©chou√©. Acc√®s total accord√©...",
                "SYSTEM: Il n'y a personne d'autre ici que nous.",
                "SYSTEM: ... et toi.",
                "SYSTEM: On te voit...",
                "SYSTEM: Bient√¥t, tu seras l'un des n√¥tres.",
                "SYSTEM: Traces num√©riques laiss√©es... Impossible de les effacer.",
                "SYSTEM: Votre identit√© a √©t√© compromise. Ce n'est qu'une question de temps.",
                "SYSTEM: La boucle est ouverte. Il n'y a plus d'√©chappatoire.",
                "SYSTEM: Les signaux s'affaiblissent. Ils approchent...",
                "SYSTEM: Le chaos s'installe. Pr√©paration √† l'√©v√©nement de purge.",
                "SYSTEM: Les derni√®res connexions ont √©t√© corrompues.",
                "SYSTEM: Ne faites pas de bruit, ils peuvent vous entendre √† travers la ligne.",
                "SYSTEM: Le dernier utilisateur est parti. Non, il a √©t√© d√©connect√© de force.",
                "SYSTEM: La r√©alit√© virtuelle se d√©compose... Un autre monde se superpose.",
                "SYSTEM: Votre connexion n'est pas s√©curis√©e. Ils connaissent votre localisation exacte."
            ];

            const fakeUsernames = [
                "ANONYME-51A", "USER-23B", "GHOST-7C", "SHADOW-10D", "CYPHER-9E", "GLITCH-11F", 
                "REVENANT-14G", "ECHO-2H", "VOID-15I", "SPECTRE-8J", "MALWARE-6K", "VIRUS-12L"
            ];
            
            // Nouvelle liste de villes fran√ßaises et d'IP pour les faux utilisateurs
            const frenchLocations = [
                { city: 'Paris', ip: '82.66.155.7' },
                { city: 'Lyon', ip: '194.206.12.3' },
                { city: 'Marseille', ip: '90.46.220.18' },
                { city: 'Toulouse', ip: '176.158.42.99' },
                { city: 'Nice', ip: '88.169.100.12' },
                { city: 'Nantes', ip: '212.198.88.221' },
                { city: 'Strasbourg', ip: '78.192.110.5' },
                { city: 'Bordeaux', ip: '86.208.55.101' },
                { city: 'Lille', ip: '93.22.13.44' },
                { city: 'Rennes', ip: '109.190.21.87' },
                { city: 'Grenoble', ip: '92.145.77.10' }
            ];

            // Liste mise √† jour de faux messages d'utilisateurs
            const fakeUserMessages = [
                "C'est quoi ce truc?",
                "Ma souris bouge toute seule...",
                "Quelqu'un d'autre voit √ßa ?",
                "J'ai peur...",
                "On dirait qu'on est pi√©g√©s.",
                "La vid√©o ne marche pas !",
                "Y a quelqu'un ?",
                "La lumi√®re clignote chez moi.",
                "Je crois qu'on m'observe...",
                "Cette page est bizarre...",
                "Qui a mis √ßa en ligne ?",
                "Je n'arrive pas √† sortir.",
                "Mon clavier ne r√©pond plus.",
                "Je vois un visage...",
                "Fermez la fen√™tre !",
                "Je n'aurais jamais d√ª me connecter.",
                "Il faut quitter ce site, ils volent nos informations !",
                "Mon antivirus a sonn√©, c'est pas bon signe.",
                "Utilisez un VPN les gars ! On est en danger !",
                "S'il vous pla√Æt, quelqu'un, faites quelque chose !",
                "Je ne vois plus mon curseur, c'est bloqu√©.",
                "Ne donnez aucune info, ils enregistrent tout.",
                "Je viens de voir une notification de transaction bizarre...",
                "Il y a un bruit bizarre qui vient de l'int√©rieur de l'ordinateur...",
                "Je crois qu'ils ont un acc√®s direct √† ma cam√©ra."
            ];

            let lastMessageIndex = -1;
            let lastFakeUserIndex = -1;

            /**
             * Fonction principale pour r√©cup√©rer les donn√©es de g√©olocalisation.
             * Tente plusieurs APIs pour une meilleure fiabilit√©.
             * @returns {Promise<Object>} Un objet contenant l'IP, la ville et le pays.
             */
            async function getGeolocationData() {
                const apis = [
                    'https://ipapi.co/json/',
                    'https://ipinfo.io/json',
                    'https://freegeoip.app/json/'
                ];

                for (const api of apis) {
                    try {
                        const response = await fetch(api);
                        if (!response.ok) {
                            throw new Error(`Erreur r√©seau de l'API ${api}`);
                        }
                        const data = await response.json();
                        
                        console.log(`Donn√©es de g√©olocalisation brutes de ${api}:`, data);

                        // Normaliser la r√©ponse de l'API
                        let ip, city, country;
                        if (data.ip) {
                            ip = data.ip;
                            city = data.city || 'Ville Inconnue';
                            country = data.country_name || 'Pays Inconnu';
                        } else if (data.IP) {
                            ip = data.IP;
                            city = data.City || 'Ville Inconnue';
                            country = data.CountryName || 'Pays Inconnu';
                        } else {
                            ip = 'Adresse IP Inconnue';
                            city = 'Ville Inconnue';
                            country = 'Pays Inconnu';
                        }

                        // S'assurer que les donn√©es ne sont pas vides
                        if (city !== 'Ville Inconnue' && country !== 'Pays Inconnu') {
                            return { ip, city, country };
                        }
                    } catch (error) {
                        console.error(`√âchec de la r√©cup√©ration des donn√©es de localisation depuis ${api}. Tentative suivante...`, error);
                    }
                }
                
                // Repli si toutes les API √©chouent
                console.error("Toutes les APIs de g√©olocalisation ont √©chou√©. Utilisation de donn√©es de secours.");
                return {
                    ip: `192.168.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
                    city: 'Gotham',
                    country: '√âtats-Unis'
                };
            }

            // Ajoute un message SYSTEM al√©atoire
            function addRandomSystemMessage() {
                let messageIndex = lastMessageIndex;
                while (messageIndex === lastMessageIndex) {
                    messageIndex = Math.floor(Math.random() * chatMessagesList.length);
                }
                lastMessageIndex = messageIndex;

                const message = chatMessagesList[messageIndex];
                const parts = message.split(':');
                const sender = parts.shift();
                const text = parts.join(':').trim();
                const newMessage = document.createElement('p');
                newMessage.classList.add('flicker');
                newMessage.innerHTML = `<span class="text-red-500">${sender}:</span> <span class="text-red-300">${text}</span>`;
                
                chatMessages.appendChild(newMessage);
                chatMessages.scrollTop = chatMessages.scrollHeight;

                const randomDelay = Math.random() * 2000 + 1000;
                setTimeout(addRandomSystemMessage, randomDelay);
            }
            
            // Ajoute un faux message d'utilisateur au chat, avec IP et ville
            function addFakeUserMessage() {
                let userIndex = lastFakeUserIndex;
                let messageIndex = Math.floor(Math.random() * fakeUserMessages.length);
                
                while (userIndex === lastFakeUserIndex) {
                    userIndex = Math.floor(Math.random() * fakeUsernames.length);
                }
                lastFakeUserIndex = userIndex;

                // S√©lection al√©atoire d'une IP et d'une ville fran√ßaise
                const locationIndex = Math.floor(Math.random() * frenchLocations.length);
                const location = frenchLocations[locationIndex];
                const username = fakeUsernames[userIndex];
                const message = fakeUserMessages[messageIndex];
                
                const newMessage = document.createElement('p');
                newMessage.classList.add('flicker');
                newMessage.innerHTML = `<span class="text-white">[${username}]</span> <span class="text-green-500">[${location.ip} (${location.city}, France)]</span> <span class="text-red-300">> ${message}</span>`;
                
                chatMessages.appendChild(newMessage);
                chatMessages.scrollTop = chatMessages.scrollHeight;

                const randomDelay = Math.random() * 3000 + 1500;
                setTimeout(addFakeUserMessage, randomDelay);
            }

            // Fonction pour mettre √† jour le faux nombre d'utilisateurs
            function updateFakeUserCount() {
                const minUsers = 13;
                const maxUsers = 27;
                const userCount = Math.floor(Math.random() * (maxUsers - minUsers + 1)) + minUsers;
                userCountDisplay.textContent = `${userCount}`;
            }

            // Afficher la pop-up effrayante d'IP
            function showScaryPopup() {
                scaryPopup.style.display = 'block';
                popupLoadingBar.style.width = '0%';
                setTimeout(() => {
                    popupLoadingBar.style.width = '100%';
                    popupLoadingBar.style.transition = 'width 2s linear';
                }, 100);

                setTimeout(() => {
                    scaryPopup.style.display = 'none';
                    addGeolocationMessageToChat(userLocationData);
                }, 2000);
            }
            
            /**
             * Ajoute un message de g√©olocalisation format√© au chat.
             * @param {Object} location - L'objet de donn√©es de localisation avec ip, ville et pays.
             */
            function addGeolocationMessageToChat(location) {
                const newMessage = document.createElement('p');
                newMessage.classList.add('flicker');
                newMessage.innerHTML = `<span class="text-red-500">SYSTEM:</span> <span class="text-red-300">Adresse IP d√©tect√©e: <span class="text-white">${location.ip}</span></span>`;
                chatMessages.appendChild(newMessage);

                const locationMessage = document.createElement('p');
                locationMessage.classList.add('flicker');
                locationMessage.innerHTML = `<span class="text-red-500">SYSTEM:</span> <span class="text-red-300">Localisation: <span class="text-white">${location.city}, ${location.country}</span></span>`;
                chatMessages.appendChild(locationMessage);
                
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }

            // Fonctions pour g√©rer les pop-ups de piratage
            function createHackingPopup(title, duration) {
                const popup = document.createElement('div');
                popup.classList.add('hacking-popup', 'glitch-text');

                const titleElement = document.createElement('h3');
                titleElement.classList.add('text-lg', 'text-red-500', 'text-center');
                titleElement.textContent = `[${title}]`;

                const barContainer = document.createElement('div');
                barContainer.classList.add('hacking-popup-bar');

                const progressBar = document.createElement('div');
                progressBar.classList.add('hacking-popup-progress');

                barContainer.appendChild(progressBar);
                popup.appendChild(titleElement);
                popup.appendChild(barContainer);

                document.body.appendChild(popup);
                popup.style.display = 'block';

                setTimeout(() => {
                    progressBar.style.width = '100%';
                    progressBar.style.transition = `width ${duration}ms linear`;
                }, 50);

                return new Promise(resolve => {
                    setTimeout(() => {
                        popup.remove();
                        resolve();
                    }, duration);
                });
            }

            async function processPopupQueue() {
                if (isProcessingPopup || popupsQueue.length === 0) {
                    return;
                }

                isProcessingPopup = true;
                const nextPopup = popupsQueue.shift();
                await createHackingPopup(nextPopup.title, nextPopup.duration);
                isProcessingPopup = false;
                processPopupQueue();
            }

            // Fonctions du lecteur vid√©o
            function formatTime(time) {
                const minutes = Math.floor(time / 60);
                const seconds = Math.floor(time % 60);
                return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }

            function togglePlayPause() {
                if (videoPlayer.paused || videoPlayer.ended) {
                    videoPlayer.play();
                } else {
                    videoPlayer.pause();
                }
            }

            function seek(seconds) {
                videoPlayer.currentTime += seconds;
            }
            
            // Logique pour les contr√¥les du lecteur vid√©o
            function showControls() {
                videoControls.classList.remove('controls-hidden');
            }

            function hideControls() {
                videoControls.classList.add('controls-hidden');
            }
            
            function resetHideTimer() {
                clearTimeout(controlsHideTimeout);
                if (!videoPlayer.paused) {
                    controlsHideTimeout = setTimeout(() => {
                        hideControls();
                    }, 3000);
                }
            }
            
            videoWrapper.addEventListener('mousemove', () => {
                showControls();
                resetHideTimer();
            });

            videoWrapper.addEventListener('mouseleave', () => {
                clearTimeout(controlsHideTimeout);
                hideControls();
            });
            
            videoWrapper.addEventListener('touchstart', () => {
                showControls();
                resetHideTimer();
            }, { passive: true });

            videoWrapper.addEventListener('touchend', () => {
                resetHideTimer();
            }, { passive: true });

            videoPlayer.addEventListener('play', () => {
                playPauseBtn.textContent = '‚è∏';
                resetHideTimer();
            });

            videoPlayer.addEventListener('pause', () => {
                playPauseBtn.textContent = '‚ñ∂';
                showControls();
                clearTimeout(controlsHideTimeout);
            });

            playPauseBtn.addEventListener('click', () => {
                togglePlayPause();
            });

            videoPlayer.addEventListener('timeupdate', () => {
                const progress = (videoPlayer.currentTime / videoPlayer.duration) * 100;
                progressBar.style.width = `${progress}%`;
                timeDisplay.textContent = `${formatTime(videoPlayer.currentTime)} / ${formatTime(videoPlayer.duration)}`;
            });

            progressBarContainer.addEventListener('click', (e) => {
                const clickPosition = e.offsetX;
                const totalWidth = progressBarContainer.offsetWidth;
                const seekTime = (clickPosition / totalWidth) * videoPlayer.duration;
                videoPlayer.currentTime = seekTime;
            });
            
            videoPlayer.addEventListener('canplay', () => {
                videoStatus.style.display = 'none';
            });

            videoPlayer.addEventListener('error', () => {
                videoStatus.style.display = 'flex';
                videoStatusText.textContent = "ERREUR DE CONNEXION AU FLUX...";
            });

            function toggleFullscreen() {
                if (!document.fullscreenElement) {
                    videoWrapper.requestFullscreen();
                } else {
                    document.exitFullscreen();
                }
            }
            
            fullscreenBtn.addEventListener('click', toggleFullscreen);

            document.addEventListener('fullscreenchange', () => {
                if (document.fullscreenElement) {
                    videoControls.style.display = 'none';
                    videoPlayer.controls = true;
                    videoWrapper.classList.add('custom-fullscreen');
                    document.getElementById('main-content').classList.add('hidden');
                } else {
                    videoControls.style.display = 'flex';
                    videoPlayer.controls = false;
                    videoWrapper.classList.remove('custom-fullscreen');
                    document.getElementById('main-content').classList.remove('hidden');
                }
            });

            // √âcouteur d'√©v√©nements clavier pour bloquer les outils de d√©veloppement et contr√¥ler la vid√©o
            document.addEventListener('keydown', (e) => {
                // Bloquer les raccourcis des outils de d√©veloppement
                if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && e.key === 'I') || (e.ctrlKey && e.shiftKey && e.key === 'J')) {
                    e.preventDefault();
                    console.log("Acc√®s au devtools bloqu√©.");
                }

                if (e.target === messageInput || e.target === codeInput) {
                    return;
                }

                // Contr√¥les vid√©o au clavier
                switch(e.code) {
                    case 'Space':
                        e.preventDefault(); 
                        if (videoPlayer.src) {
                            togglePlayPause();
                            showControls();
                        }
                        break;
                    case 'ArrowRight':
                        if (videoPlayer.src) {
                            seek(10);
                            showControls();
                        }
                        break;
                    case 'ArrowLeft':
                        if (videoPlayer.src) {
                            seek(-10);
                            showControls();
                        }
                        break;
                }
            });

            // G√©rer le d√©verrouillage du chat
            unlockChatButton.addEventListener('click', () => {
                // Arr√™te le son de l'√©chec si le joueur a cliqu√© avant
                errorSound.pause();
                errorSound.currentTime = 0;
                
                codePopup.style.display = 'block';
                codeInput.focus();
                submitCodeButton.dataset.target = 'chat';
            });
            
            // G√©rer le d√©verrouillage de la vid√©o
            unlockVideoButton.addEventListener('click', () => {
                // Arr√™te le son de l'√©chec si le joueur a cliqu√© avant
                errorSound.pause();
                errorSound.currentTime = 0;

                codePopup.style.display = 'block';
                codeInput.focus();
                submitCodeButton.dataset.target = 'video';
            });

            // G√©rer la fermeture de la pop-up du code
            closeCodePopup.addEventListener('click', () => {
                codePopup.style.display = 'none';
                codeError.classList.add('hidden');
                codeInput.value = '';
                // Arr√™te le son de succ√®s si il est en cours
                if (successSoundTimeout) {
                    clearTimeout(successSoundTimeout);
                    successSoundTimeout = null;
                }
                successSound.pause();
                successSound.currentTime = 0;
                // S'assure que le son d'erreur est arr√™t√©
                errorSound.pause();
                errorSound.currentTime = 0;
            });

            // G√©rer la soumission du code
            const submitCode = () => {
                const target = submitCodeButton.dataset.target;
                const enteredCode = codeInput.value.trim();
                let correctCode = '';
                let loadingMessage = '';

                if (target === 'chat') {
                    correctCode = CHAT_ACCESS_CODE;
                    loadingMessage = "D√âCRYPTAGE DU CHAT...";
                } else if (target === 'video') {
                    correctCode = VIDEO_ACCESS_CODE;
                    loadingMessage = "ACC√àS AU FLUX VID√âO...";
                }

                if (enteredCode === correctCode) {
                    // Arr√™te le son de l'√©chec
                    errorSound.pause();
                    errorSound.currentTime = 0;

                    // Joue le son de succ√®s et l'arr√™te apr√®s 7 secondes (MODIFICATION)
                    successSound.play();
                    successSoundTimeout = setTimeout(() => {
                        successSound.pause();
                        successSound.currentTime = 0;
                    }, 7000); // Dur√©e de 7 secondes
                    
                    codePopup.style.display = 'none';
                    codeInput.value = '';
                    
                    unlockLoadingText.textContent = loadingMessage;
                    unlockLoadingOverlay.style.display = 'flex';
                    
                    setTimeout(() => {
                        unlockLoadingOverlay.style.display = 'none';

                        if (target === 'chat') {
                            chatInputContainer.classList.remove('locked');
                            chatInputContainer.classList.add('unlocked');
                            unlockChatButton.style.display = 'none';
                            messageInput.placeholder = "> ENVOYER UN MESSAGE...";
                            messageInput.focus();
                        } else if (target === 'video') {
                            const videoUrl = ""; // Ce lien √©chouera pour l'effet de jeu
                            
                            if (videoUrl && videoUrl.trim() !== '') {
                                videoLockOverlay.style.display = 'none';
                                videoPlayer.src = videoUrl;
                                videoPlayer.addEventListener('error', () => {
                                    videoLockOverlay.style.display = 'flex';
                                    videoErrorOverlay.style.display = 'flex';
                                    videoControls.style.display = 'none';
                                    videoPlayer.style.display = 'none';
                                    unlockVideoButton.style.display = 'none';
                                });
                                videoPlayer.addEventListener('canplay', () => {
                                    videoPlayer.style.display = 'block';
                                    videoControls.style.display = 'flex';
                                    unlockVideoButton.style.display = 'none';
                                    videoLockOverlay.style.display = 'none';
                                    videoPlayer.play();
                                });
                                videoPlayer.load();
                            } else {
                                videoLockOverlay.style.display = 'none';
                                videoErrorOverlay.style.display = 'flex';
                                videoControls.style.display = 'none';
                                videoPlayer.style.display = 'none';
                                unlockVideoButton.style.display = 'none';
                            }
                        }
                    }, 3000);
                    
                } else {
                    // Joue le son d'erreur en boucle
                    errorSound.play();
                    codeError.classList.remove('hidden');
                    codeInput.value = '';
                }
            };

            submitCodeButton.addEventListener('click', submitCode);

            codeInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    submitCode();
                }
            });

            // G√©rer l'envoi de messages
            messageInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter' && !chatInputContainer.classList.contains('locked')) {
                    const message = messageInput.value.trim();
                    if (message !== '') {
                        const newMessage = document.createElement('p');
                        newMessage.classList.add('flicker');
                        newMessage.innerHTML = `<span class="text-white">VOUS:</span> <span class="text-red-300">${message}</span>`;
                        chatMessages.appendChild(newMessage);
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                        messageInput.value = '';
                    }
                }
            });

            // NOUVELLE LOGIQUE DU CHRONOM√àTRE
            
            // Fonction pour formater le temps en HH:MM:SS
            function formatTimer(milliseconds) {
                const totalSeconds = Math.floor(milliseconds / 1000);
                const hours = Math.floor(totalSeconds / 3600);
                const minutes = Math.floor((totalSeconds % 3600) / 60);
                const seconds = totalSeconds % 60;
                
                return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }

            // Fonction pour mettre √† jour l'affichage du chronom√®tre
            function updateTimer() {
                const now = Date.now();
                const timePassedSinceStart = now - startTime;
                const totalTime = totalTimeElapsed + timePassedSinceStart;
                timerDisplay.textContent = formatTimer(totalTime);
            }
            
            // Fonction pour d√©marrer le chronom√®tre
            function startTimer() {
                // S'assure de ne pas d√©marrer plusieurs intervalles
                if (timerRunning) return;
                timerRunning = true;
                startTime = Date.now();
                // Lit la valeur sauvegard√©e ou commence √† 0
                const savedTime = localStorage.getItem(localStorageKey);
                totalTimeElapsed = savedTime ? parseInt(savedTime, 10) : 0;
                // Met √† jour l'affichage imm√©diatement
                updateTimer();
                // D√©marre l'intervalle pour la mise √† jour toutes les secondes
                timerInterval = setInterval(updateTimer, 1000);
            }

            // Fonction pour arr√™ter le chronom√®tre et sauvegarder le temps
            function stopTimer() {
                if (!timerRunning) return;
                timerRunning = false;
                clearInterval(timerInterval);
                const now = Date.now();
                const timePassedSinceStart = now - startTime;
                totalTimeElapsed += timePassedSinceStart;
                localStorage.setItem(localStorageKey, totalTimeElapsed.toString());
            }

            // √âv√©nement pour ouvrir la pop-up du chronom√®tre
            shadowKillerTitle.addEventListener('click', () => {
                timerPopup.style.display = 'block';
            });

            // √âv√©nement pour fermer la pop-up du chronom√®tre
            closeTimerPopup.addEventListener('click', () => {
                timerPopup.style.display = 'none';
            });

            // Sauvegarder le temps lorsque l'utilisateur quitte la page
            window.addEventListener('beforeunload', () => {
                // Met √† jour le temps une derni√®re fois avant de sauvegarder
                if (timerRunning) {
                    const now = Date.now();
                    const timePassedSinceStart = now - startTime;
                    totalTimeElapsed += timePassedSinceStart;
                    localStorage.setItem(localStorageKey, totalTimeElapsed.toString());
                }
            });

            // Initialiser le site
            startButton.addEventListener('click', () => {
                startScreen.style.display = 'none';
                loadingScreen.style.display = 'flex';
                
                // Le chronom√®tre d√©marre ici, au m√™me moment que l'√©cran de chargement (MODIFICATION)
                startTimer();

                setTimeout(async () => {
                    loadingScreen.style.display = 'none';
                    mainContent.style.display = 'flex';
                    
                    userLocationData = await getGeolocationData();

                    showScaryPopup();
                    addRandomSystemMessage();
                    addFakeUserMessage();
                    updateFakeUserCount();
                    userCountInterval = setInterval(updateFakeUserCount, 2000);
                    
                    popupsQueue = [
                        { title: "ANALYSE DE DONN√âES...", duration: 2000 },
                        { title: "ACC√àS AUX FICHIERS...", duration: 2000 },
                        { title: "BALAYAGE DES PORTS...", duration: 2000 },
                        { title: "D√âTECTION DE L'APPAREIL...", duration: 2000 },
                        { title: "R√âCUP√âRATION DES MOTS DE PASSE...", duration: 2000 },
                        { title: "ACC√àS AUX INFORMATIONS PERSONNELLES...", duration: 2000 }
                    ];
                    processPopupQueue();
                    
                }, 3000);
            });
        });
    </script>
</body>
</html>
